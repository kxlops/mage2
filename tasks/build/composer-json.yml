---
- name: kxlops | mage2 | build - composer.json data with first found file locations
  debug:
    msg:
      - '---------------------- Searching these locations ---------------------------------------'
      - 'environment and role specific: {{ role_path }}/templates/env/{{ kxlops_workspace_env }}/{{ kxlops_workspace_role }}/'
      - 'environment specific and role independent: {{ role_path }}/templates/env/{{ kxlops_workspace_env }}/all/'
      - '{{ role_path }}/templates/env/default/all/'

- name: kxlops | mage2 | build - composer.json - BACKUP IS MADE
  template:
    src: '{{ item }}'
    dest: '{{ kxlops_mage2_composer_json_path }}'
    backup: yes
  with_first_found:
    - files:
      - '{{ kxlops_mage2_template_composer_json }}'
      paths:
      # custom location source
      #- '{{ kxlops_mage2_template_composer_json_custom }}/'
      # environment and role specific
      - '{{ role_path }}/templates/env/{{ kxlops_workspace_env }}/{{ kxlops_workspace_role }}/'
      # environment specific and role independent
      - '{{ role_path }}/templates/env/{{ kxlops_workspace_env }}/all/'
      # default
      - 'templates/env/default/all/'
  register: composer_found
  delegate_to: '{{ kxlops_mage2_build_delegate_to }}'

- debug:
    var: composer_found


